# 性能要点（精简版）

## 批处理
- 建议批大小：1000（兼顾网络与内存）
- 客户端分批、顺序或小并发提交；失败可按批重试

## 接口与网络
- JSON 体尽量精简，仅传必要字段
- 默认启用压缩与限流；避免超大单次请求

## 数据校验
- 仅提交有效指纹 `fingerprint`（64位十六进制 SHA256）；无效条目服务端会拒绝/跳过

## 服务器侧优化（对接方无需改动）
- 布隆过滤器：减少不必要的数据库查询
- 缓存：热点数据与会话差异缓存
- 数据库：复合唯一索引 `{ userKey, fingerprint }`，查询使用投影与 `lean()`
- 限流：查询/同步/管理接口使用不同策略

## 建议的客户端实践
- 先 `/check` 再决定是否继续
- 分批+重试（指数退避）；幂等提交避免重复写
- 记录批次进度，支持断点续传

## 目标指标（参考）
- 单用户 4-5 万指纹
- 预检查 < 100ms；批次差异 < 1s（取决于数据与硬件）
- 并发用户：~10（可按部署水平扩展）